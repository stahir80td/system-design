<svg viewBox="0 0 1500 900" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1500" height="900" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="750" y="35" font-size="26" font-weight="bold" text-anchor="middle" fill="#1a1a1a">Google Drive Architecture - File Storage and Sync</text>
  
  <!-- Client Layer -->
  <g id="clients">
    <text x="100" y="75" font-size="14" font-weight="bold" fill="#666">Client Layer</text>
    
    <rect x="50" y="90" width="120" height="50" rx="5" fill="#4285F4" />
    <text x="110" y="110" text-anchor="middle" fill="white" font-size="11">Web Interface</text>
    <text x="110" y="125" text-anchor="middle" fill="white" font-size="9">(Browser)</text>
    
    <rect x="50" y="150" width="120" height="50" rx="5" fill="#34A853" />
    <text x="110" y="170" text-anchor="middle" fill="white" font-size="11">Desktop Client</text>
    <text x="110" y="185" text-anchor="middle" fill="white" font-size="9">(Sync Engine)</text>
    
    <rect x="50" y="210" width="120" height="50" rx="5" fill="#EA4335" />
    <text x="110" y="230" text-anchor="middle" fill="white" font-size="11">Mobile App</text>
    <text x="110" y="245" text-anchor="middle" fill="white" font-size="9">(iOS/Android)</text>
  </g>
  
  <!-- API Gateway -->
  <rect x="230" y="150" width="130" height="60" rx="5" fill="#FF5722" />
  <text x="295" y="175" text-anchor="middle" fill="white" font-size="12">API Gateway</text>
  <text x="295" y="195" text-anchor="middle" fill="white" font-size="10">(Auth/Routing)</text>
  
  <!-- Application Services -->
  <g id="services">
    <text x="450" y="75" font-size="14" font-weight="bold" fill="#666">Application Services</text>
    
    <!-- Upload/Download -->
    <rect x="420" y="90" width="120" height="50" rx="5" fill="#0F9D58" />
    <text x="480" y="110" text-anchor="middle" fill="white" font-size="11">Upload/Download</text>
    <text x="480" y="125" text-anchor="middle" fill="white" font-size="9">(Resumable)</text>
    
    <!-- Sync Service -->
    <rect x="560" y="90" width="120" height="50" rx="5" fill="#4285F4" />
    <text x="620" y="110" text-anchor="middle" fill="white" font-size="11">Sync Service</text>
    <text x="620" y="125" text-anchor="middle" fill="white" font-size="9">(Merkle Tree)</text>
    
    <!-- Metadata Service -->
    <rect x="700" y="90" width="120" height="50" rx="5" fill="#DB4437" />
    <text x="760" y="110" text-anchor="middle" fill="white" font-size="11">Metadata Service</text>
    <text x="760" y="125" text-anchor="middle" fill="white" font-size="9">(File Info)</text>
    
    <!-- Chunking Service -->
    <rect x="420" y="150" width="120" height="50" rx="5" fill="#F4B400" />
    <text x="480" y="170" text-anchor="middle" fill="black" font-size="11">Chunking Service</text>
    <text x="480" y="185" text-anchor="middle" fill="black" font-size="9">(4MB Blocks)</text>
    
    <!-- Dedup Service -->
    <rect x="560" y="150" width="120" height="50" rx="5" fill="#9C27B0" />
    <text x="620" y="170" text-anchor="middle" fill="white" font-size="11">Dedup Service</text>
    <text x="620" y="185" text-anchor="middle" fill="white" font-size="9">(Content Hash)</text>
    
    <!-- Sharing Service -->
    <rect x="700" y="150" width="120" height="50" rx="5" fill="#00ACC1" />
    <text x="760" y="170" text-anchor="middle" fill="white" font-size="11">Sharing Service</text>
    <text x="760" y="185" text-anchor="middle" fill="white" font-size="9">(Permissions)</text>
  </g>
  
  <!-- Collaboration & Search -->
  <g id="collab">
    <rect x="850" y="90" width="120" height="50" rx="5" fill="#FF6F00" />
    <text x="910" y="110" text-anchor="middle" fill="white" font-size="11">Collaboration</text>
    <text x="910" y="125" text-anchor="middle" fill="white" font-size="9">(Real-time OT)</text>
    
    <rect x="850" y="150" width="120" height="50" rx="5" fill="#6A1B9A" />
    <text x="910" y="170" text-anchor="middle" fill="white" font-size="11">Search Service</text>
    <text x="910" y="185" text-anchor="middle" fill="white" font-size="9">(ElasticSearch)</text>
  </g>
  
  <!-- Processing Pipeline -->
  <g id="processing">
    <text x="1050" y="75" font-size="14" font-weight="bold" fill="#666">Processing</text>
    
    <rect x="1020" y="90" width="110" height="50" rx="5" fill="#795548" />
    <text x="1075" y="110" text-anchor="middle" fill="white" font-size="11">Compression</text>
    <text x="1075" y="125" text-anchor="middle" fill="white" font-size="9">(Zstd)</text>
    
    <rect x="1020" y="150" width="110" height="50" rx="5" fill="#607D8B" />
    <text x="1075" y="170" text-anchor="middle" fill="white" font-size="11">Encryption</text>
    <text x="1075" y="185" text-anchor="middle" fill="white" font-size="9">(AES-256)</text>
    
    <rect x="1150" y="90" width="110" height="50" rx="5" fill="#FF5252" />
    <text x="1205" y="110" text-anchor="middle" fill="white" font-size="11">Virus Scanner</text>
    <text x="1205" y="125" text-anchor="middle" fill="white" font-size="9">(ClamAV)</text>
    
    <rect x="1150" y="150" width="110" height="50" rx="5" fill="#536DFE" />
    <text x="1205" y="170" text-anchor="middle" fill="white" font-size="11">Thumbnail Gen</text>
    <text x="1205" y="185" text-anchor="middle" fill="white" font-size="9">(Preview)</text>
  </g>
  
  <!-- Notification Service -->
  <rect x="1300" y="120" width="130" height="60" rx="5" fill="#E91E63" />
  <text x="1365" y="145" text-anchor="middle" fill="white" font-size="12">Notification</text>
  <text x="1365" y="165" text-anchor="middle" fill="white" font-size="10">(WebSocket)</text>
  
  <!-- Cache Layer -->
  <g id="cache">
    <text x="450" y="250" font-size="14" font-weight="bold" fill="#666">Cache Layer</text>
    
    <rect x="420" y="270" width="130" height="60" rx="5" fill="#DC382D" />
    <text x="485" y="295" text-anchor="middle" fill="white" font-size="12">Redis Cache</text>
    <text x="485" y="315" text-anchor="middle" fill="white" font-size="10">(Metadata)</text>
    
    <rect x="570" y="270" width="130" height="60" rx="5" fill="#FF7043" />
    <text x="635" y="295" text-anchor="middle" fill="white" font-size="12">CDN</text>
    <text x="635" y="315" text-anchor="middle" fill="white" font-size="10">(Popular Files)</text>
    
    <rect x="720" y="270" width="130" height="60" rx="5" fill="#8BC34A" />
    <text x="785" y="295" text-anchor="middle" fill="white" font-size="12">Local Cache</text>
    <text x="785" y="315" text-anchor="middle" fill="white" font-size="10">(Client Side)</text>
  </g>
  
  <!-- Storage Layer -->
  <g id="storage">
    <text x="450" y="380" font-size="14" font-weight="bold" fill="#666">Storage Layer</text>
    
    <!-- Block Storage -->
    <rect x="420" y="400" width="140" height="60" rx="5" fill="#1565C0" />
    <text x="490" y="425" text-anchor="middle" fill="white" font-size="12">Block Storage</text>
    <text x="490" y="445" text-anchor="middle" fill="white" font-size="10">(Deduplicated)</text>
    
    <!-- Metadata DB -->
    <rect x="580" y="400" width="140" height="60" rx="5" fill="#00695C" />
    <text x="650" y="425" text-anchor="middle" fill="white" font-size="12">PostgreSQL</text>
    <text x="650" y="445" text-anchor="middle" fill="white" font-size="10">(File Metadata)</text>
    
    <!-- DynamoDB -->
    <rect x="740" y="400" width="140" height="60" rx="5" fill="#FF6F00" />
    <text x="810" y="425" text-anchor="middle" fill="white" font-size="12">DynamoDB</text>
    <text x="810" y="445" text-anchor="middle" fill="white" font-size="10">(Chunk Registry)</text>
    
    <!-- Cold Storage -->
    <rect x="900" y="400" width="140" height="60" rx="5" fill="#37474F" />
    <text x="970" y="425" text-anchor="middle" fill="white" font-size="12">Cold Storage</text>
    <text x="970" y="445" text-anchor="middle" fill="white" font-size="10">(Archive)</text>
  </g>
  
  <!-- Deduplication Flow -->
  <g id="dedup-flow">
    <rect x="50" y="520" width="650" height="160" rx="5" fill="#f5f5f5" stroke="#999" />
    <text x="60" y="540" font-size="14" font-weight="bold" fill="#333">Deduplication Process</text>
    
    <rect x="70" y="560" width="100" height="40" rx="5" fill="#4CAF50" />
    <text x="120" y="580" text-anchor="middle" fill="white" font-size="10">File Upload</text>
    <text x="120" y="595" text-anchor="middle" fill="white" font-size="9">100MB</text>
    
    <rect x="200" y="560" width="100" height="40" rx="5" fill="#2196F3" />
    <text x="250" y="580" text-anchor="middle" fill="white" font-size="10">Chunk File</text>
    <text x="250" y="595" text-anchor="middle" fill="white" font-size="9">25 x 4MB</text>
    
    <rect x="330" y="560" width="100" height="40" rx="5" fill="#FF9800" />
    <text x="380" y="580" text-anchor="middle" fill="white" font-size="10">Hash Chunks</text>
    <text x="380" y="595" text-anchor="middle" fill="white" font-size="9">SHA-256</text>
    
    <rect x="460" y="560" width="100" height="40" rx="5" fill="#9C27B0" />
    <text x="510" y="580" text-anchor="middle" fill="white" font-size="10">Check Exists</text>
    <text x="510" y="595" text-anchor="middle" fill="white" font-size="9">15 exist</text>
    
    <rect x="590" y="560" width="100" height="40" rx="5" fill="#F44336" />
    <text x="640" y="580" text-anchor="middle" fill="white" font-size="10">Upload New</text>
    <text x="640" y="595" text-anchor="middle" fill="white" font-size="9">10 x 4MB</text>
    
    <!-- Arrows -->
    <line x1="170" y1="580" x2="200" y2="580" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
    <line x1="300" y1="580" x2="330" y2="580" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
    <line x1="430" y1="580" x2="460" y2="580" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
    <line x1="560" y1="580" x2="590" y2="580" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
    
    <text x="70" y="630" font-size="11" fill="#666">Result: Only 40MB uploaded instead of 100MB (60% saved)</text>
    <text x="70" y="650" font-size="11" fill="#666">Common blocks (OS files, libraries) shared across users</text>
  </g>
  
  <!-- Sync Protocol -->
  <g id="sync-flow">
    <rect x="750" y="520" width="650" height="160" rx="5" fill="#f5f5f5" stroke="#999" />
    <text x="760" y="540" font-size="14" font-weight="bold" fill="#333">Sync Protocol (Merkle Tree)</text>
    
    <!-- Tree visualization -->
    <circle cx="1075" cy="580" r="15" fill="#4285F4"/>
    <text x="1075" y="585" text-anchor="middle" fill="white" font-size="10">Root</text>
    
    <circle cx="1000" cy="620" r="12" fill="#34A853"/>
    <text x="1000" y="625" text-anchor="middle" fill="white" font-size="9">F1</text>
    
    <circle cx="1050" cy="620" r="12" fill="#34A853"/>
    <text x="1050" y="625" text-anchor="middle" fill="white" font-size="9">F2</text>
    
    <circle cx="1100" cy="620" r="12" fill="#EA4335"/>
    <text x="1100" y="625" text-anchor="middle" fill="white" font-size="9">F3</text>
    
    <circle cx="1150" cy="620" r="12" fill="#34A853"/>
    <text x="1150" y="625" text-anchor="middle" fill="white" font-size="9">F4</text>
    
    <!-- Lines -->
    <line x1="1075" y1="595" x2="1000" y2="608" stroke="#333" stroke-width="1" />
    <line x1="1075" y1="595" x2="1050" y2="608" stroke="#333" stroke-width="1" />
    <line x1="1075" y1="595" x2="1100" y2="608" stroke="#333" stroke-width="1" />
    <line x1="1075" y1="595" x2="1150" y2="608" stroke="#333" stroke-width="1" />
    
    <text x="1220" y="580" font-size="11" fill="#333">1. Compare root hash</text>
    <text x="1220" y="600" font-size="11" fill="#333">2. If different, compare children</text>
    <text x="1220" y="620" font-size="11" fill="#333">3. Find changed nodes (F3)</text>
    <text x="1220" y="640" font-size="11" fill="#333">4. Sync only changes</text>
    
    <text x="760" y="660" font-size="11" fill="#666">Efficient O(log n) change detection</text>
  </g>
  
  <!-- Connection Lines -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
  </defs>
  
  <!-- Client to API Gateway -->
  <line x1="170" y1="180" x2="230" y2="180" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  
  <!-- API Gateway to Services -->
  <line x1="360" y1="180" x2="420" y2="115" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="360" y1="180" x2="560" y2="115" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  
  <!-- Services to Processing -->
  <line x1="540" y1="175" x2="1020" y2="115" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  
  <!-- Services to Cache -->
  <line x1="480" y1="140" x2="485" y2="270" stroke="#333" stroke-width="2" marker-end="url(#arrow)" />
  
  <!-- Cache to Storage -->
  <line x1="485" y1="330" x2="490" y2="400" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrow)" />
  <line x1="635" y1="330" x2="650" y2="400" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrow)" />
  
  <!-- Key Metrics -->
  <g id="metrics">
    <rect x="50" y="720" width="700" height="120" rx="5" fill="#f9f9f9" stroke="#ddd" />
    <text x="60" y="740" font-size="13" font-weight="bold" fill="#333">System Scale:</text>
    <text x="60" y="760" font-size="11" fill="#666">• 1 billion users, 500M daily active</text>
    <text x="60" y="778" font-size="11" fill="#666">• 50 Exabytes total storage (35EB after dedup)</text>
    <text x="60" y="796" font-size="11" fill="#666">• 100 trillion files</text>
    <text x="60" y="814" font-size="11" fill="#666">• 4MB chunk size for deduplication</text>
    
    <text x="380" y="760" font-size="11" fill="#666">• 10 billion file operations/day</text>
    <text x="380" y="778" font-size="11" fill="#666">• 1 million changes/second</text>
    <text x="380" y="796" font-size="11" fill="#666">• 40% storage saved via dedup</text>
    <text x="380" y="814" font-size="11" fill="#666">• Sub-second sync for small files</text>
  </g>
  
  <!-- Features -->
  <g id="features">
    <rect x="800" y="720" width="600" height="120" rx="5" fill="#f9f9f9" stroke="#ddd" />
    <text x="810" y="740" font-size="13" font-weight="bold" fill="#333">Key Features:</text>
    <text x="810" y="760" font-size="11" fill="#666">• Block-level deduplication</text>
    <text x="810" y="778" font-size="11" fill="#666">• Merkle tree for efficient sync</text>
    <text x="810" y="796" font-size="11" fill="#666">• Delta sync for large files</text>
    <text x="810" y="814" font-size="11" fill="#666">• Operational transformation for collaboration</text>
    
    <text x="1080" y="760" font-size="11" fill="#666">• Content-addressed storage</text>
    <text x="1080" y="778" font-size="11" fill="#666">• Resumable uploads</text>
    <text x="1080" y="796" font-size="11" fill="#666">• Offline support with conflict resolution</text>
    <text x="1080" y="814" font-size="11" fill="#666">• End-to-end encryption available</text>
  </g>
</svg>